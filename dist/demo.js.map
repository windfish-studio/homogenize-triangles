{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///delegated ./node_modules/three/build/three.module.js from dll-reference vendor","webpack:///./src/homogenize-triangles.js","webpack:///external \"vendor\"","webpack:///./src/demo.js","webpack:///./src/util/fastRounding.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Vector3","require","fastRounding","verts","faces","facenormals","tol","slice","spatialIndex","createOrShareVtx","vtx","points","toArray","currentPath","forEach","_n","_i","_p","length","undefined","push","x","y","z","faceNormal","splitFace","vecs","map","_f","vertIdx","segs","_v","vecIndices","deltaVec","subVectors","do_split","j","orderedSegs","sort","_sa","_sb","sharedVtx","shared","_o","_vi","newVertsIdx","_oa","_ob","crossVectors","angleTo","Math","PI","half","clone","multiplyScalar","newVtx","add","_fb","_fc","b","e","vendor","PerspectiveCamera","Scene","WebGLRenderer","MeshBasicMaterial","Mesh","Points","PointsMaterial","BufferGeometry","Float32BufferAttribute","Uint32BufferAttribute","PlaneGeometry","SphereGeometry","homogenizeTriangles","HomogenizeTrianglesDemo","constructor","geo","this","container","window","document","body","geometry","tolerance","perFrameRotation","init","animate","buildGeometry","computeBoundingSphere","computeBoundingBox","computeFaceNormals","computeVertexNormals","set","setGeometry","rebuildScene","setTolerance","scene","children","remove","dispose","material","buildScene","createMultiMesh","meshes","mesh","wireframe","color","transparent","opacity","size","_m","_t","position","dividedTri","res","vertices","flat","a","normal","addAttribute","Float32Array","from","setIndex","Uint32Array","onWindowResize","renderer","setSize","innerWidth","innerHeight","camera","aspect","domElement","clientWidth","clientHeight","updateProjectionMatrix","lookAt","updateMatrixWorld","setPixelRatio","devicePixelRatio","appendChild","addEventListener","requestAnimationFrame","rotation","render","tol_select","getElementById","geo_select","option","createElement","innerText","String","demo","parseInt","target","sigFigs","pow","floor","round"],"mappings":"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","file":"demo.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","module.exports = (__webpack_require__(2))(1);","const {Vector3} = require('three');\nconst fastRounding = require('./util/fastRounding');\n\nconst sigFigs = 5;\n\nmodule.exports = function homogenizeTriangles (verts, faces, facenormals, tol) {\n    verts = verts.slice(0);\n    faces = faces.slice(0);\n    facenormals = facenormals.slice(0);\n\n    const spatialIndex = {};\n\n    const createOrShareVtx = (vtx) => {\n        const points = vtx.toArray();\n        let currentPath = spatialIndex;\n\n        points.forEach((_n, _i) => {\n            let _p = fastRounding(_n, sigFigs);\n            if(_p == -0){\n                _p = 0;\n            }\n\n            if(_i == (points.length - 1)){\n                if(currentPath[_p] === undefined){\n                    verts.push(vtx.x, vtx.y, vtx.z);\n                    currentPath[_p] = (verts.length / 3) - 1;\n                }\n            }else{\n                currentPath[_p] = currentPath[_p] || {};\n            }\n\n            currentPath = currentPath[_p];\n        });\n\n        return currentPath;\n    };\n\n    for(var i = 0; i < faces.length; i += 3) {\n\n        let faceNormal = new Vector3(\n            facenormals[i],\n            facenormals[i+1],\n            facenormals[i+2]\n        );\n\n        let splitFace = () => {\n            const vecs = [0, 1, 2].map(_f => {\n                const vertIdx = faces[i + _f] * 3;\n                return new Vector3(\n                    verts[vertIdx],\n                    verts[vertIdx + 1],\n                    verts[vertIdx + 2]\n                );\n            });\n\n            const segs = vecs.map((_v, _i) => {\n                return {\n                    vecIndices: [_i, (_i+1)%3],\n                    deltaVec: (new Vector3()).subVectors(vecs[(_i+1)%3], _v)\n                };\n            });\n\n            let do_split = false;\n            for(var j = 0; j < 3; j++){\n                if(segs[j].deltaVec.length() > tol){\n                    do_split = true;\n                    break;\n                }\n            }\n\n            if(!do_split){\n                return;\n            }\n\n            let orderedSegs = segs.sort((_sa, _sb)=>{return (_sa.deltaVec.length() > _sb.deltaVec.length())? -1 : 1}).slice(0,2);\n            let sharedVtx = null;\n\n            //find the vertex shared by the two longest edges\n            const shared = {};\n            orderedSegs.forEach(_o => {\n                _o.vecIndices.forEach(_vi => {\n                    shared[_vi] = shared[_vi] || 0;\n                    shared[_vi]++;\n\n                    if(shared[_vi] == 2){\n                        sharedVtx = _vi;\n                    }\n                });\n            });\n\n            orderedSegs = orderedSegs.sort((_oa, _ob) => {\n\n                const cross = (new Vector3()).crossVectors(_oa.deltaVec, _ob.deltaVec);\n                const ang = cross.angleTo(faceNormal);\n\n                return (ang < (Math.PI/2))? -1 : 1;\n            });\n\n            //create two new vertices\n            const newVertsIdx = orderedSegs.map(_o => {\n                const half = _o.deltaVec.clone().multiplyScalar(0.5);\n\n                const newVtx = vecs[_o.vecIndices[0]].clone();\n                newVtx.add(half);\n\n                return createOrShareVtx(newVtx);\n\n            });\n\n            //rearrange the faces\n            const _fb = i + ((sharedVtx + 1) % 3);\n            const _fc = i + ((sharedVtx + 2) % 3);\n            const b = faces[_fb];\n            const c = faces[_fc];\n            const d = newVertsIdx[0];\n            const e = newVertsIdx[1];\n\n            faces[_fb] = e;\n            faces[_fc] = d;\n\n            faces.push(d, b, c);\n            faces.push(d, e, b);\n\n            //copy this facenormal twice (one for each new face)\n            [0,1].forEach(() => {\n                facenormals.push(faceNormal.x, faceNormal.y, faceNormal.z);\n            });\n\n            return splitFace();\n        };\n\n        splitFace();\n    }\n\n    return {\n        verts: verts,\n        faces: faces,\n        facenormals: facenormals\n    }\n};","module.exports = vendor;","const {\n    PerspectiveCamera,\n    Scene,\n    WebGLRenderer,\n    Vector3,\n    MeshBasicMaterial,\n    Mesh,\n    Points,\n    PointsMaterial,\n    BufferGeometry,\n    Float32BufferAttribute,\n    Uint32BufferAttribute,\n    PlaneGeometry,\n    SphereGeometry\n} = require('three');\n\nconst homogenizeTriangles = require('./homogenize-triangles');\n\nclass HomogenizeTrianglesDemo {\n\n    constructor (tol, geo) {\n        this.container = window.document.body;\n        this.geometry = geo;\n        this.tolerance = tol;\n        this.perFrameRotation = new Vector3();\n        this.init();\n        this.animate();\n    }\n\n    buildGeometry () {\n        let geo;\n        switch(this.geometry){\n            case 'plane':\n                geo = new PlaneGeometry(15, 4);\n                geo.computeBoundingSphere();\n                geo.computeBoundingBox();\n                geo.computeFaceNormals();\n                geo.computeVertexNormals();\n                this.perFrameRotation.set(0,0,0);\n                break;\n            case 'sphere':\n                geo = new SphereGeometry(10, 5, 5);\n                geo.computeBoundingSphere();\n                geo.computeBoundingBox();\n                geo.computeFaceNormals();\n                geo.computeVertexNormals();\n                this.perFrameRotation.set(0.001,0.005,0);\n                break;\n        }\n\n        return geo;\n    }\n\n    setGeometry(geo){\n        this.geometry = geo;\n        this.rebuildScene();\n    }\n\n    setTolerance(tol){\n        this.tolerance = tol;\n        this.rebuildScene();\n    }\n\n    rebuildScene () {\n        while(this.scene.children.length){\n            let _o = this.scene.children[0];\n            this.scene.remove(_o);\n            _o.geometry.dispose();\n            _o.material.dispose();\n        };\n\n        this.buildScene();\n    }\n\n    buildScene () {\n        const geo = this.buildGeometry();\n\n        const createMultiMesh = (geo) => {\n            const meshes = [];\n\n            let mesh = new Mesh(geo, new MeshBasicMaterial({\n                wireframe: true,\n                color: 0xffffff\n            }));\n\n            meshes.push(mesh);\n\n            mesh = new Mesh(geo, new MeshBasicMaterial({\n                transparent: true,\n                opacity: 0.2,\n                color: 0xffffff\n            }));\n\n            meshes.push(mesh);\n\n            mesh = new Points(geo, new PointsMaterial({\n                size: 0.4,\n                color: 0xffffff\n            }));\n\n            meshes.push(mesh);\n\n            meshes.forEach(_m => {\n                this.scene.add(_m);\n            });\n\n            return meshes;\n        };\n\n        createMultiMesh(geo).forEach(_t => {\n            _t.position.x = -10;\n        });\n\n        const dividedTri = new BufferGeometry();\n        const res = homogenizeTriangles(\n            geo.vertices.map(_v => {return _v.toArray()}).flat(),\n            geo.faces.map(_f => {return [_f.a, _f.b, _f.c]}).flat(),\n            geo.faces.map(_f => {return _f.normal.toArray() }).flat(),\n            this.tolerance\n        );\n\n        dividedTri.addAttribute('position', new Float32BufferAttribute(Float32Array.from(res.verts), 3));\n        dividedTri.setIndex(new Uint32BufferAttribute(Uint32Array.from(res.faces), 1));\n\n        createMultiMesh(dividedTri).forEach(_t => {\n            _t.position.x = 10;\n        });\n    }\n\n    onWindowResize () {\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n        this.camera.aspect = this.renderer.domElement.clientWidth / this.renderer.domElement.clientHeight;\n        this.camera.updateProjectionMatrix();\n        this.renderer.setSize( this.renderer.domElement.clientWidth, this.renderer.domElement.clientHeight );\n    }\n\n    init () {\n        this.scene = new Scene();\n\n        this.camera = new PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 1000 );\n        this.camera.position.z = 30;\n        this.camera.lookAt(new Vector3(0,0,0));\n        this.camera.updateMatrixWorld();\n\n        this.renderer = new WebGLRenderer();\n        this.renderer.setPixelRatio( window.devicePixelRatio );\n        this.renderer.setSize( window.innerWidth, window.innerHeight );\n\n        this.container.appendChild( this.renderer.domElement );\n\n        window.addEventListener( 'resize', ()=>{\n            this.onWindowResize();\n        }, false );\n\n        this.buildScene();\n    }\n\n    animate(){\n        requestAnimationFrame( () => {\n            this.animate();\n        } );\n\n        this.scene.children.forEach(_o => {\n            _o.rotation.x += this.perFrameRotation.x;\n            _o.rotation.y += this.perFrameRotation.y;\n        });\n\n        this.renderer.render( this.scene, this.camera );\n    }\n}\n\nwindow.addEventListener('DOMContentLoaded', function () {\n\n    const tol_select = document.getElementById('tolerance');\n    const geo_select = document.getElementById('geometry');\n\n    for(var i = 0; i < 10; i++){\n        const option = document.createElement('option');\n        option.innerText = new String(i+1);\n        option.value = i+1;\n        tol_select.appendChild(option);\n    }\n\n    tol_select.addEventListener('change', function (e) {\n        window.demo.setTolerance(parseInt(e.target.value));\n    });\n    tol_select.value = new String(10);\n\n    geo_select.addEventListener('change', function (e) {\n        window.demo.setGeometry(e.target.value);\n    });\n    geo_select.value = 'sphere';\n\n    window.demo = new HomogenizeTrianglesDemo(tol_select.value, geo_select.value);\n});\n\n","module.exports = function (_n, sigFigs) {\n    const p = Math.pow(10,sigFigs);\n    if(_n === -0)\n        return 0;\n    return (Math.floor(Math.round(_n*p)) / p)\n};"],"sourceRoot":""}